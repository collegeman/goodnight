# Lisa

AI-powered project management agent for Laravel applications. Lisa watches GitHub issues, generates PRDs, implements features using Claude, deploys per-task staging sites on Laravel Forge, and creates pull requests — all automatically.

## Architecture

Lisa runs as a Laravel package on a dedicated Forge site (the "orchestrator"). When a GitHub issue is labeled `lisa`, she:

1. **Intake** — Parses the issue and generates a PRD
2. **Planning** — Breaks the PRD into implementation steps
3. **Implementing** — Uses Claude to write code on a feature branch
4. **Deploying** — Creates a per-task staging site on the same Forge server
5. **Testing** — Posts the staging URL to the issue for review
6. **Iterating** — Incorporates feedback from issue comments
7. **Creating PR** — Opens a pull request when you comment `lisa:done`

### Forge Multi-Site Staging

Each task gets its own Forge site and MySQL database on the same server as the orchestrator. Domains use sslip.io for automatic DNS resolution (e.g., `lisa-42.203.0.113.25.sslip.io`). Sites are destroyed automatically when the PR is merged.

## Requirements

- PHP 8.2+
- Laravel 11 or 12
- Laravel Forge account with a provisioned server
- GitHub repository with a fine-grained personal access token
- Anthropic API key (Claude)

## Installation

```bash
composer require collegeman/lisa
php artisan lisa:setup
```

## Configuration

All configuration is via environment variables:

| Variable | Description |
|---|---|
| `LISA_ENVIRONMENT` | App environment name for Lisa (default: `lisa`) |
| `LISA_GITHUB_TOKEN` | GitHub fine-grained personal access token |
| `LISA_GITHUB_OWNER` | GitHub repository owner |
| `LISA_GITHUB_REPO` | GitHub repository name |
| `LISA_GITHUB_WEBHOOK_SECRET` | Webhook secret (auto-generated by setup) |
| `LISA_CLAUDE_API_KEY` | Anthropic API key |
| `LISA_FORGE_TOKEN` | Forge API token |
| `LISA_FORGE_SERVER_ID` | Forge server ID |
| `LISA_FORGE_SITE_ID` | Forge site ID (orchestrator) |
| `LISA_FORGE_SERVER_IP` | Server IP address (for sslip.io domains) |
| `LISA_MAX_TASK_SITES` | Max concurrent task sites (default: 3) |
| `LISA_QUEUE` | Queue name (default: `lisa`) |

## Setup

Run `php artisan lisa:setup` for a guided wizard that walks through:

1. **GitHub** — Repository and token configuration
2. **Claude** — Anthropic API key
3. **Forge** — API token
4. **Server** — Provision or select a Forge server
5. **Site** — Create the orchestrator site, install git, deploy
6. **Webhook** — Create the GitHub webhook
7. **Verify** — Test connectivity to all services

## Commands

- `php artisan lisa:setup` — Run the setup wizard
- `php artisan lisa:status` — Show active tasks with status, branch, and staging URL
- `php artisan lisa:retry` — Retry a failed task

## License

MIT
